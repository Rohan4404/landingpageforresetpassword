<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Password Reset</title>
  </head>
  <body>
    <h1>Password Reset</h1>
    <p>
      If you are not redirected automatically,
      <a id="app-link" href="#">click here</a> to open the app.
    </p>

    <script>
      (function () {
        const params = new URLSearchParams(window.location.search);
        const token = params.get("token");

        if (!token) {
          document.body.innerHTML = "<p>Invalid or missing token.</p>";
          return;
        }

        const appUrl = `myapp://reset-password?token=${encodeURIComponent(
          token
        )}`;
        const fallbackUrl = "https://yourdomain.com/instructions.html"; // Optional: page explaining how to install app or use web reset

        // Set the href of the clickable link for fallback
        const appLink = document.getElementById("app-link");
        appLink.href = appUrl;

        // Try to redirect to the app after a short delay
        setTimeout(() => {
          window.location = appUrl;
        }, 1000);

        // After 2 seconds, redirect to fallback page in case app is not installed
        setTimeout(() => {
          window.location = fallbackUrl;
        }, 3000);
      })();
    </script>
  </body>
</html>
